{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jonis/OneDrive/Desktop/sonic-garage/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { useEffect, useMemo, useState } from \"react\";\n\ntype Dash = {\n  ym: string;\n  cards: {\n    teHyra: string;\n    kostoPjesesh: string;\n    shpenzimeTjera: string;\n    fitimNeto: string;\n    borxhiTopTotal: string;\n  };\n  servise: Array<{\n    servisId: string;\n    dataServisit: string;\n    pershkrimi: string;\n    automjet: string;\n    targa: string;\n    klient: string;\n  }>;\n  lowStock: Array<{ inventarId: string; emri: string; sasiaStok: number }>;\n  borxheTop: Array<{ faktureId: string; nrFakture: string; klient: string; borxh: string }>;\n};\n\nfunction thisMonthYM() {\n  const d = new Date();\n  const y = d.getFullYear();\n  const m = String(d.getMonth() + 1).padStart(2, \"0\");\n  return `${y}-${m}`;\n}\n\nexport default function DashboardPage() {\n  const [ym, setYm] = useState(thisMonthYM());\n  const [data, setData] = useState<Dash | null>(null);\n  const [err, setErr] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  async function load() {\n    setLoading(true);\n    setErr(null);\n\n    const res = await fetch(`/api/dashboard?ym=${encodeURIComponent(ym)}`);\n    const d = await res.json().catch(() => ({}));\n\n    if (!res.ok) {\n      setErr(d?.error ?? \"Gabim\");\n      setData(null);\n      setLoading(false);\n      return;\n    }\n\n    setData(d);\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    load();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ym]);\n\n  const cards = useMemo(() => {\n    if (!data) return null;\n    return {\n      teHyra: Number(data.cards.teHyra),\n      kosto: Number(data.cards.kostoPjesesh),\n      shpenzime: Number(data.cards.shpenzimeTjera),\n      fitimNeto: Number(data.cards.fitimNeto),\n      borxhi: Number(data.cards.borxhiTopTotal),\n    };\n  }, [data]);\n\n  return (\n    <div className=\"space-y-6 text-gray-900\">\n      <div className=\"flex flex-col gap-3 md:flex-row md:items-end md:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-semibold\">Dashboard</h1>\n          <p className=\"text-sm text-gray-700\">Përmbledhje mujore (EUR) + servise hap.</p>\n        </div>\n\n        <div className=\"flex items-end gap-2\">\n          <div className=\"text-sm text-gray-700\">Muaji</div>\n          <input\n            className=\"rounded-lg border px-3 py-2\"\n            type=\"month\"\n            value={ym}\n            onChange={(e) => setYm(e.target.value)}\n          />\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"text-sm text-gray-700\">Duke ngarku…</div>\n      ) : err ? (\n        <div className=\"rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-700\">{err}</div>\n      ) : !data || !cards ? null : (\n        <>\n          <div className=\"grid gap-3 md:grid-cols-5\">\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"text-sm text-gray-700\">Të hyra</div>\n              <div className=\"text-xl font-semibold\">{cards.teHyra.toFixed(2)} €</div>\n              <div className=\"mt-2 text-xs text-gray-600\">\n                <Link className=\"underline\" href=\"/faktura\">Shiko faturat</Link>\n              </div>\n            </div>\n\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"text-sm text-gray-700\">Kosto pjesësh</div>\n              <div className=\"text-xl font-semibold\">{cards.kosto.toFixed(2)} €</div>\n              <div className=\"mt-2 text-xs text-gray-600\">\n                (DALJE nga inventari)\n              </div>\n            </div>\n\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"text-sm text-gray-700\">Shpenzime tjera</div>\n              <div className=\"text-xl font-semibold\">{cards.shpenzime.toFixed(2)} €</div>\n              <div className=\"mt-2 text-xs text-gray-600\">\n                <Link className=\"underline\" href=\"/shpenzime\">Menaxho shpenzimet</Link>\n              </div>\n            </div>\n\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"text-sm text-gray-700\">Fitim neto</div>\n              <div className={`text-xl font-semibold ${cards.fitimNeto >= 0 ? \"text-green-700\" : \"text-red-700\"}`}>\n                {cards.fitimNeto.toFixed(2)} €\n              </div>\n              <div className=\"mt-2 text-xs text-gray-600\">\n                <Link className=\"underline\" href=\"/raporte\">Raporte</Link>\n              </div>\n            </div>\n\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"text-sm text-gray-700\">Borxhe (Top)</div>\n              <div className={`text-xl font-semibold ${cards.borxhi > 0 ? \"text-red-700\" : \"text-green-700\"}`}>\n                {cards.borxhi.toFixed(2)} €\n              </div>\n              <div className=\"mt-2 text-xs text-gray-600\">\n                (fatura me borxh)\n              </div>\n            </div>\n          </div>\n\n          <div className=\"grid gap-3 md:grid-cols-2\">\n            {/* Servise hap */}\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"flex items-center justify-between\">\n                <h2 className=\"font-semibold\">Servise Hap</h2>\n                <Link className=\"text-sm underline\" href=\"/servise\">Të gjitha</Link>\n              </div>\n\n              {data.servise.length === 0 ? (\n                <div className=\"mt-2 text-sm text-gray-700\">S’ka servise hap.</div>\n              ) : (\n                <div className=\"mt-3 space-y-2\">\n                  {data.servise.map((s) => (\n                    <div key={s.servisId} className=\"rounded-lg border p-3\">\n                      <div className=\"flex items-start justify-between gap-3\">\n                        <div>\n                          <div className=\"font-semibold\">\n                            {s.automjet} {s.targa ? `(${s.targa})` : \"\"}\n                          </div>\n                          <div className=\"text-sm text-gray-700\">{s.klient}</div>\n                          {s.pershkrimi ? <div className=\"mt-1 text-sm text-gray-700\">{s.pershkrimi}</div> : null}\n                        </div>\n                        <Link className=\"rounded-lg border px-2 py-1 hover:bg-gray-50\" href={`/servise/${s.servisId}`}>\n                          Hape\n                        </Link>\n                      </div>\n                      <div className=\"mt-2 text-xs text-gray-600\">\n                        {new Date(s.dataServisit).toLocaleString()}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            {/* Low stock */}\n            <div className=\"rounded-xl border bg-white p-4\">\n              <div className=\"flex items-center justify-between\">\n                <h2 className=\"font-semibold\">Low-stock</h2>\n                <Link className=\"text-sm underline\" href=\"/inventar\">Inventar</Link>\n              </div>\n\n              {data.lowStock.length === 0 ? (\n                <div className=\"mt-2 text-sm text-gray-700\">Nuk ka low-stock (≤ 2).</div>\n              ) : (\n                <div className=\"mt-3 space-y-2\">\n                  {data.lowStock.map((x) => (\n                    <div key={x.inventarId} className=\"rounded-lg border p-3 flex items-center justify-between\">\n                      <div>\n                        <div className=\"font-semibold\">{x.emri}</div>\n                        <div className=\"text-sm text-gray-700\">Stok: {x.sasiaStok}</div>\n                      </div>\n                      <Link className=\"rounded-lg border px-2 py-1 hover:bg-gray-50\" href=\"/inventar\">\n                        Hape\n                      </Link>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Borxhe top */}\n          <div className=\"rounded-xl border bg-white p-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"font-semibold\">Borxhe (Top)</h2>\n              <Link className=\"text-sm underline\" href=\"/faktura\">Fatura</Link>\n            </div>\n\n            {data.borxheTop.length === 0 ? (\n              <div className=\"mt-2 text-sm text-gray-700\">S’ka borxhe.</div>\n            ) : (\n              <div className=\"mt-3 overflow-x-auto\">\n                <table className=\"w-full text-sm\">\n                  <thead className=\"border-b text-left text-gray-800\">\n                    <tr>\n                      <th className=\"py-2\">Fatura</th>\n                      <th>Klienti</th>\n                      <th>Borxh (€)</th>\n                      <th className=\"text-right\">Veprime</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {data.borxheTop.map((b) => (\n                      <tr key={b.faktureId} className=\"border-b\">\n                        <td className=\"py-2 font-semibold\">{b.nrFakture}</td>\n                        <td>{b.klient}</td>\n                        <td className=\"font-semibold text-red-700\">{Number(b.borxh).toFixed(2)}</td>\n                        <td className=\"text-right\">\n                          <Link className=\"rounded-lg border px-2 py-1 hover:bg-gray-50\" href={`/faktura/${b.faktureId}`}>\n                            Hape\n                          </Link>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 743, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jonis/OneDrive/Desktop/sonic-garage/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,0JACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}}]
}